{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNativeReanimated","_hooks","_findNodeHandle","_useCombinedRef","_interopRequireDefault","_useSmoothKeyboardHandler","_utils","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_extends","assign","bind","arguments","length","apply","KeyboardAwareScrollView","forwardRef","children","onLayout","bottomOffset","disableScrollOnKeyboardHide","enabled","extraKeyboardSpace","ScrollViewComponent","Reanimated","ScrollView","snapToOffsets","rest","ref","scrollViewAnimatedRef","useAnimatedRef","scrollViewRef","React","useRef","onRef","useCombinedRef","scrollViewTarget","useSharedValue","scrollPosition","position","useScrollViewOffset","currentKeyboardFrameHeight","keyboardHeight","keyboardWillAppear","tag","initialKeyboardSize","scrollBeforeKeyboardMovement","input","update","useReanimatedFocusedInput","layout","lastSelection","height","useWindowDimensions","onScrollViewLayout","useCallback","value","findNodeHandle","current","maybeScroll","animated","_layout$value","_layout$value2","_layout$value3","parentScrollViewTarget","visibleRect","absoluteY","inputHeight","point","relativeScrollTo","interpolatedScrollTo","interpolate","scrollDistanceWithRespectToSnapPoints","targetScrollY","Math","max","scrollTo","positionOnScreen","topOfScreen","performScrollWithPositionRestoration","newPosition","prevScroll","syncKeyboardFrame","keyboardFrame","updateLayoutFromSelection","_lastSelection$value","_input$value","customHeight","selection","end","y","clamp","scrollFromCurrentPosition","prevLayout","onChangeText","onChangeTextHandler","useMemo","debounce","onSelectionChange","_lastSelection$value2","_lastSelection$value3","lastTarget","target","latestSelection","start","useFocusedInputHandler","useSmoothKeyboardHandler","onStart","keyboardWillChangeSize","keyboardWillHide","focusWasChanged","onMove","onEnd","synchronize","runOnUI","useImperativeHandle","scrollView","existingMethods","assureFocusedInputVisible","useEffect","useAnimatedReaction","previous","view","useAnimatedStyle","paddingBottom","createElement","scrollEventThrottle","View","style","_default","exports"],"sources":["index.tsx"],"sourcesContent":["import React, {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n} from \"react\";\nimport Reanimated, {\n  clamp,\n  interpolate,\n  runOnUI,\n  scrollTo,\n  useAnimatedReaction,\n  useAnimatedRef,\n  useAnimatedStyle,\n  useScrollViewOffset,\n  useSharedValue,\n} from \"react-native-reanimated\";\n\nimport {\n  useFocusedInputHandler,\n  useReanimatedFocusedInput,\n  useWindowDimensions,\n} from \"../../hooks\";\nimport { findNodeHandle } from \"../../utils/findNodeHandle\";\nimport useCombinedRef from \"../hooks/useCombinedRef\";\n\nimport { useSmoothKeyboardHandler } from \"./useSmoothKeyboardHandler\";\nimport { debounce, scrollDistanceWithRespectToSnapPoints } from \"./utils\";\n\nimport type {\n  LayoutChangeEvent,\n  ScrollView,\n  ScrollViewProps,\n} from \"react-native\";\nimport type {\n  FocusedInputLayoutChangedEvent,\n  FocusedInputSelectionChangedEvent,\n  NativeEvent,\n} from \"react-native-keyboard-controller\";\n\nexport type KeyboardAwareScrollViewProps = {\n  /** The distance between the keyboard and the caret inside a focused `TextInput` when the keyboard is shown. Default is `0`. */\n  bottomOffset?: number;\n  /** Prevents automatic scrolling of the `ScrollView` when the keyboard gets hidden, maintaining the current screen position. Default is `false`. */\n  disableScrollOnKeyboardHide?: boolean;\n  /** Controls whether this `KeyboardAwareScrollView` instance should take effect. Default is `true`. */\n  enabled?: boolean;\n  /** Adjusting the bottom spacing of KeyboardAwareScrollView. Default is `0`. */\n  extraKeyboardSpace?: number;\n  /** Custom component for `ScrollView`. Default is `ScrollView`. */\n  ScrollViewComponent?: React.ComponentType<ScrollViewProps>;\n} & ScrollViewProps;\nexport type KeyboardAwareScrollViewRef = {\n  assureFocusedInputVisible: () => void;\n} & ScrollView;\n\n// Everything begins from `onStart` handler. This handler is called every time,\n// when keyboard changes its size or when focused `TextInput` was changed. In\n// this handler we are calculating/memoizing values which later will be used\n// during layout movement. For that we calculate:\n// - layout of focused field (`layout`) - to understand whether there will be overlap\n// - initial keyboard size (`initialKeyboardSize`) - used in scroll interpolation\n// - future keyboard height (`keyboardHeight`) - used in scroll interpolation\n// - current scroll position (`scrollPosition`) - used to scroll from this point\n//\n// Once we've calculated all necessary variables - we can actually start to use them.\n// It happens in `onMove` handler - this function simply calls `maybeScroll` with\n// current keyboard frame height. This functions makes the smooth transition.\n//\n// When the transition has finished we go to `onEnd` handler. In this handler\n// we verify, that the current field is not overlapped within a keyboard frame.\n// For full `onStart`/`onMove`/`onEnd` flow it may look like a redundant thing,\n// however there could be some cases, when `onMove` is not called:\n// - on iOS when TextInput was changed - keyboard transition is instant\n// - on Android when TextInput was changed and keyboard size wasn't changed\n// So `onEnd` handler handle the case, when `onMove` wasn't triggered.\n//\n// ====================================================================================================================+\n// -----------------------------------------------------Flow chart-----------------------------------------------------+\n// ====================================================================================================================+\n//\n// +============================+       +============================+        +==================================+\n// +  User Press on TextInput   +   =>  +  Keyboard starts showing   +   =>   + As keyboard moves frame by frame +  =>\n// +                            +       +       (run `onStart`)      +        +    `onMove` is getting called    +\n// +============================+       +============================+        +==================================+\n//\n// +============================+       +============================+        +=====================================+\n// + Keyboard is shown and we   +   =>  +    User moved focus to     +   =>   + Only `onStart`/`onEnd` maybe called +\n// +    call `onEnd` handler    +       +     another `TextInput`    +        +    (without involving `onMove`)     +\n// +============================+       +============================+        +=====================================+\n//\n\n/**\n * A ScrollView component that automatically handles keyboard appearance and disappearance\n * by adjusting its content position to ensure the focused input remains visible.\n *\n * The component uses a sophisticated animation system to smoothly handle keyboard transitions\n * and maintain proper scroll position during keyboard interactions.\n *\n * @returns A ScrollView component that handles keyboard interactions.\n * @see {@link https://kirillzyusko.github.io/react-native-keyboard-controller/docs/api/components/keyboard-aware-scroll-view|Documentation} page for more details.\n * @example\n * ```tsx\n * <KeyboardAwareScrollView bottomOffset={20}>\n *   <TextInput placeholder=\"Enter text\" />\n *   <TextInput placeholder=\"Another input\" />\n * </KeyboardAwareScrollView>\n * ```\n */\nconst KeyboardAwareScrollView = forwardRef<\n  KeyboardAwareScrollViewRef,\n  React.PropsWithChildren<KeyboardAwareScrollViewProps>\n>(\n  (\n    {\n      children,\n      onLayout,\n      bottomOffset = 0,\n      disableScrollOnKeyboardHide = false,\n      enabled = true,\n      extraKeyboardSpace = 0,\n      ScrollViewComponent = Reanimated.ScrollView,\n      snapToOffsets,\n      ...rest\n    },\n    ref,\n  ) => {\n    const scrollViewAnimatedRef = useAnimatedRef<Reanimated.ScrollView>();\n    const scrollViewRef = React.useRef<ScrollView>(null);\n    const onRef = useCombinedRef(scrollViewAnimatedRef, scrollViewRef);\n    const scrollViewTarget = useSharedValue<number | null>(null);\n    const scrollPosition = useSharedValue(0);\n    const position = useScrollViewOffset(scrollViewAnimatedRef);\n    const currentKeyboardFrameHeight = useSharedValue(0);\n    const keyboardHeight = useSharedValue(0);\n    const keyboardWillAppear = useSharedValue(false);\n    const tag = useSharedValue(-1);\n    const initialKeyboardSize = useSharedValue(0);\n    const scrollBeforeKeyboardMovement = useSharedValue(0);\n    const { input, update } = useReanimatedFocusedInput();\n    const layout = useSharedValue<FocusedInputLayoutChangedEvent | null>(null);\n    const lastSelection =\n      useSharedValue<FocusedInputSelectionChangedEvent | null>(null);\n\n    const { height } = useWindowDimensions();\n\n    const onScrollViewLayout = useCallback(\n      (e: LayoutChangeEvent) => {\n        scrollViewTarget.value = findNodeHandle(scrollViewAnimatedRef.current);\n\n        onLayout?.(e);\n      },\n      [onLayout],\n    );\n\n    /**\n     * Function that will scroll a ScrollView as keyboard gets moving.\n     */\n    const maybeScroll = useCallback(\n      (e: number, animated: boolean = false) => {\n        \"worklet\";\n\n        if (!enabled) {\n          return 0;\n        }\n\n        // input belongs to ScrollView\n        if (layout.value?.parentScrollViewTarget !== scrollViewTarget.value) {\n          return 0;\n        }\n\n        const visibleRect = height - keyboardHeight.value;\n        const absoluteY = layout.value?.layout.absoluteY || 0;\n        const inputHeight = layout.value?.layout.height || 0;\n        const point = absoluteY + inputHeight;\n\n        if (visibleRect - point <= bottomOffset) {\n          const relativeScrollTo =\n            keyboardHeight.value - (height - point) + bottomOffset;\n          const interpolatedScrollTo = interpolate(\n            e,\n            [initialKeyboardSize.value, keyboardHeight.value],\n            [\n              0,\n              scrollDistanceWithRespectToSnapPoints(\n                relativeScrollTo + scrollPosition.value,\n                snapToOffsets,\n              ) - scrollPosition.value,\n            ],\n          );\n          const targetScrollY =\n            Math.max(interpolatedScrollTo, 0) + scrollPosition.value;\n\n          scrollTo(scrollViewAnimatedRef, 0, targetScrollY, animated);\n\n          return interpolatedScrollTo;\n        }\n\n        if (point < 0) {\n          const positionOnScreen = visibleRect - bottomOffset;\n          const topOfScreen = scrollPosition.value + point;\n\n          scrollTo(\n            scrollViewAnimatedRef,\n            0,\n            topOfScreen - positionOnScreen,\n            animated,\n          );\n        }\n\n        return 0;\n      },\n      [bottomOffset, enabled, height, snapToOffsets],\n    );\n    const performScrollWithPositionRestoration = useCallback(\n      (newPosition: number) => {\n        \"worklet\";\n\n        const prevScroll = scrollPosition.value;\n\n        // eslint-disable-next-line react-compiler/react-compiler\n        scrollPosition.value = newPosition;\n        maybeScroll(keyboardHeight.value, true);\n        scrollPosition.value = prevScroll;\n      },\n      [scrollPosition, keyboardHeight, maybeScroll],\n    );\n    const syncKeyboardFrame = useCallback(\n      (e: NativeEvent) => {\n        \"worklet\";\n\n        const keyboardFrame = interpolate(\n          e.height,\n          [0, keyboardHeight.value],\n          [0, keyboardHeight.value + extraKeyboardSpace],\n        );\n\n        currentKeyboardFrameHeight.value = keyboardFrame;\n      },\n      [extraKeyboardSpace],\n    );\n\n    const updateLayoutFromSelection = useCallback(() => {\n      \"worklet\";\n\n      const customHeight = lastSelection.value?.selection.end.y;\n\n      if (!input.value?.layout || !customHeight) {\n        return false;\n      }\n\n      layout.value = {\n        ...input.value,\n        layout: {\n          ...input.value.layout,\n          // when we have multiline input with limited amount of lines, then custom height can be very big\n          // so we clamp it to max input height\n          height: clamp(customHeight, 0, input.value.layout.height),\n        },\n      };\n\n      return true;\n    }, [input, lastSelection, layout]);\n    const scrollFromCurrentPosition = useCallback(() => {\n      \"worklet\";\n\n      const prevLayout = layout.value;\n\n      if (!updateLayoutFromSelection()) {\n        return;\n      }\n\n      performScrollWithPositionRestoration(position.value);\n\n      layout.value = prevLayout;\n    }, [performScrollWithPositionRestoration]);\n    const onChangeText = useCallback(() => {\n      \"worklet\";\n      scrollFromCurrentPosition();\n    }, [scrollFromCurrentPosition]);\n    const onChangeTextHandler = useMemo(\n      () => debounce(onChangeText, 200),\n      [onChangeText],\n    );\n    const onSelectionChange = useCallback(\n      (e: FocusedInputSelectionChangedEvent) => {\n        \"worklet\";\n\n        const lastTarget = lastSelection.value?.target;\n        const latestSelection = lastSelection.value?.selection;\n\n        lastSelection.value = e;\n\n        if (e.target !== lastTarget) {\n          // ignore this event, because \"focus changed\" event handled in `useSmoothKeyboardHandler`\n          return;\n        }\n        // caret in the end + end coordinates has been changed -> we moved to a new line\n        // so input may grow\n        if (\n          e.selection.end.position === e.selection.start.position &&\n          latestSelection?.end.y !== e.selection.end.y\n        ) {\n          return scrollFromCurrentPosition();\n        }\n        // selection has been changed\n        if (e.selection.start.position !== e.selection.end.position) {\n          return scrollFromCurrentPosition();\n        }\n\n        onChangeTextHandler();\n      },\n      [scrollFromCurrentPosition, onChangeTextHandler],\n    );\n\n    useFocusedInputHandler(\n      {\n        onSelectionChange: onSelectionChange,\n      },\n      [onSelectionChange],\n    );\n\n    useSmoothKeyboardHandler(\n      {\n        onStart: (e) => {\n          \"worklet\";\n\n          const keyboardWillChangeSize =\n            keyboardHeight.value !== e.height && e.height > 0;\n\n          keyboardWillAppear.value = e.height > 0 && keyboardHeight.value === 0;\n\n          const keyboardWillHide = e.height === 0;\n          const focusWasChanged =\n            (tag.value !== e.target && e.target !== -1) ||\n            keyboardWillChangeSize;\n\n          if (keyboardWillChangeSize) {\n            initialKeyboardSize.value = keyboardHeight.value;\n          }\n\n          if (keyboardWillHide) {\n            // on back transition need to interpolate as [0, keyboardHeight]\n            initialKeyboardSize.value = 0;\n            scrollPosition.value = scrollBeforeKeyboardMovement.value;\n          }\n\n          if (\n            keyboardWillAppear.value ||\n            keyboardWillChangeSize ||\n            focusWasChanged\n          ) {\n            // persist scroll value\n            scrollPosition.value = position.value;\n            // just persist height - later will be used in interpolation\n            keyboardHeight.value = e.height;\n          }\n\n          // focus was changed\n          if (focusWasChanged) {\n            tag.value = e.target;\n            // save position of focused text input when keyboard starts to move\n            updateLayoutFromSelection();\n            // save current scroll position - when keyboard will hide we'll reuse\n            // this value to achieve smooth hide effect\n            scrollBeforeKeyboardMovement.value = position.value;\n          }\n\n          if (focusWasChanged && !keyboardWillAppear.value) {\n            // update position on scroll value, so `onEnd` handler\n            // will pick up correct values\n            position.value += maybeScroll(e.height, true);\n          }\n        },\n        onMove: (e) => {\n          \"worklet\";\n\n          syncKeyboardFrame(e);\n\n          // if the user has set disableScrollOnKeyboardHide, only auto-scroll when the keyboard opens\n          if (!disableScrollOnKeyboardHide || keyboardWillAppear.value) {\n            maybeScroll(e.height);\n          }\n        },\n        onEnd: (e) => {\n          \"worklet\";\n\n          keyboardHeight.value = e.height;\n          scrollPosition.value = position.value;\n\n          syncKeyboardFrame(e);\n        },\n      },\n      [maybeScroll, disableScrollOnKeyboardHide, syncKeyboardFrame],\n    );\n\n    const synchronize = useCallback(async () => {\n      await update();\n\n      runOnUI(() => {\n        \"worklet\";\n\n        scrollFromCurrentPosition();\n      })();\n    }, [update, scrollFromCurrentPosition]);\n\n    useImperativeHandle(\n      ref,\n      () => {\n        const scrollView = scrollViewRef.current;\n\n        const existingMethods = scrollView ? { ...scrollView } : {};\n\n        return {\n          ...existingMethods,\n\n          assureFocusedInputVisible: () => {\n            synchronize();\n          },\n        } as KeyboardAwareScrollViewRef;\n      },\n      [synchronize],\n    );\n\n    useEffect(() => {\n      synchronize();\n    }, [bottomOffset]);\n\n    useAnimatedReaction(\n      () => input.value,\n      (current, previous) => {\n        if (\n          current?.target === previous?.target &&\n          current?.layout.height !== previous?.layout.height\n        ) {\n          // input has changed layout - let's check if we need to scroll\n          // may happen when you paste text, then onSelectionChange will be\n          // fired earlier than text actually changes its layout\n          scrollFromCurrentPosition();\n        }\n      },\n      [],\n    );\n\n    const view = useAnimatedStyle(\n      () =>\n        enabled\n          ? {\n              // animations become choppy when scrolling to the end of the `ScrollView` (when the last input is focused)\n              // this happens because the layout recalculates on every frame. To avoid this we slightly increase padding\n              // by `+1`. In this way we assure, that `scrollTo` will never scroll to the end, because it uses interpolation\n              // from 0 to `keyboardHeight`, and here our padding is `keyboardHeight + 1`. It allows us not to re-run layout\n              // re-calculation on every animation frame and it helps to achieve smooth animation.\n              // see: https://github.com/kirillzyusko/react-native-keyboard-controller/pull/342\n              paddingBottom: currentKeyboardFrameHeight.value + 1,\n            }\n          : {},\n      [enabled],\n    );\n\n    return (\n      <ScrollViewComponent\n        ref={onRef}\n        {...rest}\n        scrollEventThrottle={16}\n        onLayout={onScrollViewLayout}\n      >\n        {children}\n        {enabled && <Reanimated.View style={view} />}\n      </ScrollViewComponent>\n    );\n  },\n);\n\nexport default KeyboardAwareScrollView;\n"],"mappings":"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","ignoreList":[]}